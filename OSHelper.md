### Границы зоны ответственности ОС
Задачи, покрываемые ОС:
* Управление пользовательскими задачами:
1. Запуска и останов процессов
2. Планирование времени центрального процессора
3. Распределение оперативной памяти
4. Разграничение полномочий
* Управление внешними устройствами
1. Абстрагирование от особенностей устройств разных моделей
2. Координация доступа нескольких задач к одному устройству

### О системе X Window
Запуск `X Window` - `X :1`. Чтобы запустить программу необходимо нажать Ctrl-Alt-F1, далее ctrl+z  и командой `bg` убрать работающую программу `X` в фоновый режим.
Запуск прикладной программы - `DISPLAY=:1.0 xterm`.
Вернутся к Х-серверу. Alt-F7, Alt-F8.

В системе X Window за стандартные элементы оконного интерфейса отвечают специальные программы, называемые оконными менеджерами.

### Каталоги
**Каталог** - особый тип файла, хранящий имена файлов, среди которых, возможно, тоже есть каталоги

Каждая запись в каталоге состоит из двух полей - **имя файла и номер индексного дескриптора**.

Хранимая на внешнем запоминающем устройстве (диске) структура данных, содержащая всю информацию о файле, включая его имя, называется **индексным дескриптором**.

Имя файла в ОС Unix не является ни в каком виде частью или принадлежностью самого файла.

Записи в каталогах ссылающиеся на тот же самый индексный дескриптор - **жесткие ссылки**.

В индексном дескрипторе содержится счетчик количества ссылок на данный дескриптор.

В ОС Unix не предусмотрено функций удаления файла, вместо этого имеется системный вызов, удаляющий ссылку, который называется `unlink`. 

Сам файл удаляется, только если удаленная ссылка была последней (счетчик обратился в нуль) и при этом файл не был ни одним из процессов открыт на запись или чтение.

Система запрещает создание жестких ссылок на каталоги, удаление каталогов происходит с помощью команды `rmdir`.

Для создания жесткой ссылки средствами командной строки можно воспользоваться командой - `ln`.

**Символическая ссылка** (symbolic link) представляет собой файл специального типа, содержащий имя другого файла. Операция открытия символической ссылки на чтение или запись приводит к открытию файла, на который она ссылается, а не её самой. Будучи файлом, символическая ссылка имеет свой номер индексного дескриптора. Создание и удаление символической ссылки никак не затрагивает ни файл, на который она ссылается, ни его индексный дескриптор. Более того файл, на который указывает ссылка, может вообще не существовать в момент её создания, а также может быть удален позднее, что никак не повлияет на ссылку. 

> Символическая ссылка, содержащая имя несуществующего файла, называется **висячей**. Символические ссылки не ограничены рамками одного диска, поскольку реализуются через хранение имен, а дерево имен, как мы знаем, в ОС Unix общее для всех имеющихся в системе дисковых устройств.

Для создания символической ссылки средствами командной строки следует использовать уже знакомую нам команду `ln`, указав её флаг `-s`:
```
ln -s /path/to/old/name new_name
```
### Права доступа к файлам
Скриптовый файл должен начинатся со строки `#!bin/sh`, означает что для исполнения этого файла нужно запустить программу `/bin/sh` (командный интерпретатор) и передать ему имя файла скрипта через аргумент командной строки. Подойдет любой интерпретатор, знающий что его будут вызывать (`Perl`, `Scheme`, `Prolog`). Нужно перед этим навесить на скриптовый файл бит исполнения.

> Биты `SetUid` и `SetGid` для скриптов не работают

`Sticky bit` в директории дает право удалять только свои собственные файлы.

> Обычно для создания общественной директории применяются права 01777 - всем разрешается все, но при этом взведенный `Sticky bit` не позволит удалять чужие файлы.

`SetGid bit` установленный на директорию, приводит к тому, что для файлов, создаваемых в такой директории, в качестве группы пользователей принудительно устанавливается та же группа, что и для самой директории.

`ls -l` - показать права доступа, системный вызов - `stat`

Измнение прав доступа - `chmod` - системный вызов - `chmod`

Смена владельца и группы для файла - `chown`, `chgrp`, системный вызов - `chown`

### Чтение и запись содержимого файлов
Основные системные вызовы для работы с потоками ввода-вывода:
* `int open(const char *name, int mode);
* `int open(const char *name, int mode, int perms);

Чтение из потока ввода и запись в поток вывода происходит с помощью сис. вызовов:
* `int read(int fd, void *mem, int len);
* `int write(int fd, const void *data, int len)

Закрытие файла - `int close(int fd)`, даже если произошла ошибка дескриптор никогда не остается открытым.

Изменение текущей позиции в файле - `int lseek(int fd, int offset, int whence);`. Возвращает новое значение текущей позиции, считая от начала, `lseek(fd, 0, SEEK_END)` вернет длину файла, а текущей позицией станет его конец.

В большинстве случаев операции записи выполняются системой в так называемом асинхронном режиме вывода.

В явном виде дожидается завершение операции записи при асинхронном режиме - `int fsync(int fd);`.


